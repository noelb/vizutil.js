---
layout: default
title: Split Bezier
---

<style>
    /*00eedd*/
    .vizutil-cp-line {

        stroke:black;
        stroke-opacity:.5;
        stroke-width: .5;
        stroke-dasharray: 2,2;
    }

    .vizutil-cp-circle {
        stroke:#00eedd;
        stroke-opacity:1;
        stroke-width: 1;

        fill: #ffffff;
        fill-opacity: 1;

    }

    .vizutil-path {
        stroke:black;
        stroke-opacity:1;
        stroke-width: 1;
        fill: none;
    }
</style>
<pre>
//The points you want to draw a curve through
let pnts = [ {x:0,y:0}, {x:23,y:-4}, ... ];

//Will return an array of points forming a path
let splinePnts = GeomUtil.cspline(pnts,.02);
</pre>


<div class="diagram"><!-- The SVG diagram will be appended here --></div>

<form onsubmit="refresh(); return false;">
    <button>Randomize</button>

    <select title="Control Point Edit Style">
        <option selected>Mirrored</option>
        <option>Disconnected</option>
        <option>Asymmetric</option>
    </select>

</form>


<script>
var WIDTH = 500; //The size of the SVG canvas
var BORDER = 100; //Keep the points from being too close to the edges


function randomPoint() {
    return [(WIDTH - BORDER * 2) * Math.random() + BORDER, (WIDTH - BORDER * 2) * Math.random() + BORDER];
}

function randomCP(pnt) {
    return [
            pnt[0] + (Math.random()*BORDER*2 - BORDER),
            pnt[1] + (Math.random()*BORDER*2 - BORDER)
    ]
}
function randomPath(numPoints) {
    var pnts = [];
    for (var i=0; i < numPoints; i++) pnts.push( randomPoint() );
    return pnts;
}

function randomBezier(numPoints) {
    var pnts = randomPath(numPoints);
//    pnts = [
//            [100,100],[200,100],[300,100]
//            ];

    var bezier = [pnts[0]];

    for (var i=0; i < pnts.length-1; i++) {

        //Add the first control point
        var p = pnts[i];
        var cp = bezier[ bezier.length-2 ];
        if (cp == null) {
            bezier.push( randomPoint() );
        } else {
            console.log("PNT---");
            console.log(p);
            console.log(cp);

            var rot = GeomUtil.rotate(cp[0],cp[1],Math.PI,p[0],p[1]);
            console.log(rot);
            bezier.push( rot );
        }

        //Add the second control point
        bezier.push( randomCP(pnts[i+1]) );

        //Add the next point
        bezier.push(pnts[i+1]);

    }

    return bezier;
}

var mainSVG = null;


/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */


function refresh() {

    var numPoints = Math.floor(Math.random()*5) + 2;
    var bezier = randomBezier(numPoints);

    //Remove what was there before
    if (mainSVG != null) mainSVG.parentElement.removeChild(mainSVG);

    //Create an SVG document
    mainSVG = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    mainSVG.setAttribute("width", WIDTH.toString());
    mainSVG.setAttribute("height", WIDTH.toString());
    document.getElementsByClassName("diagram")[0].appendChild(mainSVG);

    //Convert a spline to an SVG path
    var pathSVG = SvgUtil.curve(document, bezier);
    console.log(pathSVG);
//    pathSVG.setAttribute("stroke", "black");
//    pathSVG.setAttribute("stroke-width", ".5");
//    pathSVG.setAttribute("opacity", ".8");
//    pathSVG.setAttribute("fill", "none");
    mainSVG.appendChild(pathSVG);

    var editSVG = SvgUtil.editControls(document,bezier,pathSVG);
    mainSVG.appendChild(editSVG);

    //pathSVG.querySelector('[data-id=0]');
    //pathSVG.querySelector('[data-id=1]');
    //[data-point-id="7febe088-4eca-493b-8455-385b39ad30e3"]

}

refresh();

</script>


</body>
</html>